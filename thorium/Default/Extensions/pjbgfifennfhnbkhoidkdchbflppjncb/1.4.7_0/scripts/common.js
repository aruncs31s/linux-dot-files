var hostname=function(t){var e=(t=t.replace("www.","")).indexOf("//")+2;if(e>1){var n=t.indexOf("/",e);return n>0||(n=t.indexOf("?",e))>0?t.substring(e,n):t.substring(e)}return t},update=function(t){app.button.label="Current State: "+t.toUpperCase(),app.button.icon={path:{32:"/assets/icons/"+t+"/32.png",64:"/assets/icons/"+t+"/64.png"}}};app.button.onCommand((function(){config.addon.state="dark"===config.addon.state?"light":"dark",update(config.addon.state)})),chrome.contextMenus.onClicked.addListener((function(t){if("dark-mode-context-menu"===t.menuItemId){var e=t.pageUrl;chrome.storage.local.get({whitelist:[]},(function(t){var n=t.whitelist;n.push(hostname(e)),n=n.filter((function(t,e,n){return t&&n.indexOf(t)===e})),chrome.storage.local.set({whitelist:n},(function(){}))}))}})),window.setTimeout((function(){update(config.addon.state)}),300),chrome.contextMenus.create({contexts:["page"],id:"dark-mode-context-menu",title:"Exclude from Dark Mode"});